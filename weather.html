<!DOCTYPE html>
  <html>
    <head lang="en">
      <meta name="viewport" content="width=device-width, initial-scale=1" charset="utf-8">
      <title> myUSA </title>

      <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
                        <!-- jQuery library -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
                        
<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
<link rel="stylesheet" type="text/css" href="mySite.css">
<script src="http://code.jquery.com/jquery-2.1.4.min.js"> </script>
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script type="text/javascript" src="mySite.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript" src="http://gsgd.co.uk/sandbox/jquery/easing/jquery.easing.1.3.js"></script>

  <!-- Latest compiled and minified CSS -->
  

  <!-- Latest compiled and minified JQuery libs -->
 
  <script src="http://hardcoredevs.com/wp-content/themes/myweb/libs/bootstrap-3.2.0-dist/js/bootstrap.min.js"></script>

  <script src="http://hardcoredevs.com/wp-content/themes/myweb/libs/textillate/jquery.textillate.js"></script>  
<script src="main.js"></script>
      <script src="http://underscorejs.org/underscore-min.js" type="text/javascript"></script>
      <script type="text/template" id="search-output">
        <div class="container" align="right">
            <div class="row">
              <div class="col-md-12">
                    <p> <!--Weather around me -->
                    <a  id ="link2" target="popup" onclick="window.open('<%=link2%>','name','width=900,height=700')">Discover map</a> </p>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6">
                <br/>
              </div>              
              <div class="col-md-2">
                <%=weather.name+","+weather.sys.country%>
              </div>
              <div class="col-md-2">
                <img src="http://goo.gl/o83Rz" alt="Processing.."/>
              </div>
              <div class="col-md-2">
               <%=Math.round(weather.main.temp-273)+"&deg;C"%>
              </div>
            </div>

            <div style="text-align:right">
                <p> <a style="text-decoration:none" href="http://openweathermap.org">OpenWeatherMap</a> is a weather source 
                </p>
            </div>
            <div id="temp" style="visibility:hidden"> <h1> Weather around you </h1> </h1>
        </div>
      </script>
      <script type="text/javascript">
        var lat = "";
        var lon = "";
        var i=0;
        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition);
            } else {
                document.getElementById("geoPosBox").innerHTML = "Geolocation is not supported by this browser.";
            }
        }
        function showPosition(position) {
            lat = position.coords.latitude;
            lon = position.coords.longitude;
            document.getElementById("geoPosBox").innerHTML = "Your coordinates (Latitude: " + position.coords.latitude +
            "&nbsp; Longitude: " + position.coords.longitude + ")&nbsp; might be used for the search result ordering";
            
        }

        
        $( document ).ready( function() {
            getLocation()
            performSearch(39.08, -77.18)
        } );


        function performSearch(x,y) {
        
            //var q = $("#search").val();
            $("#coor").innerHTML = "Latitude: " + x + "&nbsp; Longitude: " + y + "&nbsp";
            //q = q.trim();
            // perform AJAX request to search API
            $.ajax({
                url: "http://api.openweathermap.org/data/2.5/weather?lat="+x+"&lon="+y+"&appid=1c87a7a7f766cd5b4d9e91dfdf1d3ed2",
                type: "get",
                success: function(response, textStatus, jqXHR){
                    
                    var respObj = JSON.parse(jqXHR.responseText);
                    //document.getElementById("button").disabled = "disabled";
                    var searchOut = _.template( $('#search-output').html())( {weather: respObj, link2: "http://openweathermap.org/Maps?zoom=12&lat="+x+"&lon="+y+"&layers=B0FTTFF" } );
                    $("#searchResult").append( searchOut );
                },
                error: function(jqXHR, textStatus, errorThrown){
                    alert(jqXHR.status);
                }
            });
            
        }

        function hide() {
            document.getElementById("button").style.visibility="hidden";
        }
        function show() {
            document.getElementById("temp").style.visibility="visible";
        }
        
      </script>
    </head>
    <body>

    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header"> 
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"> 
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="" class="navbar-brand">NataliPage</a>
            </div>
            <div class="navbar-collapse collapse" style="height: 1px">
                
                <ul class="nav navbar-nav navbar-right">
                    <li> <a href="mySite.html">Home</a></li>
                    <li> <a href="mySite.html#who-i-am">About</a></li>
                    <li> <a href="mySite.html#contact-me">Contact</a></li>
                </ul>
                <a href="weather.html" class="btn btn-success navbar-btn"> Get weather </a>
            </div>

        </div>

    </nav>
                <br/>
                <br/>
                <br/>
                <br/>
                <div id="geoPosBox" style="color: #708090; font-size: x-small; visibility:hidden"></div>
                <br/>
                <div id='searchResult' align="right"></div>

                <div style="margin-bottom:1%;margin-top:5%;text-align: right; padding-right: 100px    ">

                     <button id="button" type="button" onclick="performSearch(lat, lon);hide();show();"> 
                    Get yours weather </button>
                </div>

        </body>
    </html>
